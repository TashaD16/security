# ‚úÖ –ú–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ - –í–∞—Ä–∏–∞–Ω—Ç 1

## üìã –†–µ–∑—é–º–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ –º–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Spring Security –≤–º–µ—Å—Ç–æ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Å–∫–∞–Ω–µ—Ä–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤.

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –£–ø—Ä–æ—â–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –£–¥–∞–ª–µ–Ω `EndpointSecurityScanner` –∏–∑ `SecurityConfig`
- –£–ø—Ä–æ—â–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è - –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ `@PreAuthorize`

### 2. –°–æ–∑–¥–∞–Ω—ã –Ω–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- `SecurityExpressionMethods` - –º–µ—Ç–æ–¥—ã –¥–ª—è SpEL –≤—ã—Ä–∞–∂–µ–Ω–∏–π
- `CustomAuthorizationHelper` - —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤
- `MethodSecurityConfig` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–µ—Ç–æ–¥–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 3. –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (8 —Ñ–∞–π–ª–æ–≤)
- –ó–∞–º–µ–Ω–µ–Ω—ã –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ (`@RequiresReadDeclaration`, `@RequiresWriteDeclaration`, etc.) –Ω–∞ `@PreAuthorize` —Å SpEL –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏

### 4. –î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- `spring-boot-starter-security` –≤ `moduleA` –∏ `moduleB`

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–£–¥–∞–ª–µ–Ω–æ –∫–æ–¥–∞**: ~330 —Å—Ç—Ä–æ–∫ (EndpointSecurityScanner)
- **–î–æ–±–∞–≤–ª–µ–Ω–æ –∫–æ–¥–∞**: ~150 —Å—Ç—Ä–æ–∫ (–Ω–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- **–ß–∏—Å—Ç–æ–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ**: ~180 —Å—Ç—Ä–æ–∫
- **–£–ø—Ä–æ—â–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: SecurityConfig —Ç–µ–ø–µ—Ä—å 90 —Å—Ç—Ä–æ–∫ –≤–º–µ—Å—Ç–æ 128

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. ‚úÖ **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –º–µ—Ç–æ–¥–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Spring Security
2. ‚úÖ **–ú–µ–Ω—å—à–µ –∫–æ–¥–∞** - —É–¥–∞–ª–µ–Ω –∫–∞—Å—Ç–æ–º–Ω—ã–π —Å–∫–∞–Ω–µ—Ä
3. ‚úÖ **–ë—ã—Å—Ç—Ä–µ–µ –∑–∞–ø—É—Å–∫** - –Ω–µ—Ç reflection-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
4. ‚úÖ **–ì–∏–±—á–µ** - SpEL –≤—ã—Ä–∞–∂–µ–Ω–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
5. ‚úÖ **–ü—Ä–æ—â–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å** - –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–∏–¥–Ω—ã –ø—Ä—è–º–æ –Ω–∞ –º–µ—Ç–æ–¥–∞—Ö

## üîß –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–∏–º–µ—Ä:
```java
@PreAuthorize("@securityMethods.canReadDeclaration(#declarationId, authentication)")
@GetMapping("/{declarationId}/details")
public Mono<ResponseEntity<Map<String, Object>>> getDetails(@PathVariable String declarationId) {
    // –ú–µ—Ç–æ–¥ –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ READ_DECLARATION
    // –∏ –≤–ª–∞–¥–µ–µ—Ç —Ä–µ—Å—É—Ä—Å–æ–º —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º declarationId
}
```

### –ú–µ—Ö–∞–Ω–∏–∑–º:
1. Spring Security –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ —á–µ—Ä–µ–∑ AOP
2. –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è SpEL –≤—ã—Ä–∞–∂–µ–Ω–∏–µ `@securityMethods.canReadDeclaration(...)`
3. –ú–µ—Ç–æ–¥ `canReadDeclaration` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –∏ –≤–ª–∞–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–º
4. –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞ - –º–µ—Ç–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –∏–Ω–∞—á–µ - 403 Forbidden

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è):
- `gateway/src/main/java/com/example/gateway/security/EndpointSecurityScanner.java`
- `gateway/src/main/java/com/example/gateway/security/EndpointSecurityScanResult.java`

### –ú–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:
1. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –º–µ—Ç–æ–¥–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
2. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ JWT/OAuth2 (—Å–º. MODERN_APPROACHES.md)
3. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø—Ä–æ–µ–∫—Ç–∞

## ‚ú® –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! –í—Å–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –º–µ—Ç–æ–¥–Ω—É—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –∫–æ–¥ —Å—Ç–∞–ª –ø—Ä–æ—â–µ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–µ–µ.
