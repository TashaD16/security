# –û–±—ä—è—Å–Ω–µ–Ω–∏–µ: exchanges.pathMatchers("/actuator/**").permitAll();

## üìã –†–∞–∑–±–æ—Ä –ø–æ —á–∞—Å—Ç—è–º

```java
exchanges.pathMatchers("/actuator/**").permitAll();
```

### 1. `exchanges`
- –≠—Ç–æ –æ–±—ä–µ–∫—Ç —Ç–∏–ø–∞ `ServerHttpSecurity.AuthorizeExchangeSpec.Access`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∞–≤–∏–ª –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ Spring Security WebFlux
- –°–æ–∑–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ü–µ–ø–æ—á–∫—É –≤—ã–∑–æ–≤–æ–≤ –≤ `authorizeExchange(exchanges -> { ... })`

### 2. `pathMatchers("/actuator/**")`
- **`pathMatchers()`** - –º–µ—Ç–æ–¥ –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è HTTP –ø—É—Ç–µ–π –∑–∞–ø—Ä–æ—Å–æ–≤
- **`"/actuator/**"`** - –ø–∞—Ç—Ç–µ—Ä–Ω –ø—É—Ç–∏:
  - `/actuator/` - –±–∞–∑–æ–≤—ã–π –ø—É—Ç—å
  - `**` - –æ–∑–Ω–∞—á–∞–µ—Ç "–ª—é–±—ã–µ –ø–æ–¥–ø—É—Ç–∏" (wildcard)
  - –ü—Ä–∏–º–µ—Ä—ã —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π:
    - ‚úÖ `/actuator/health`
    - ‚úÖ `/actuator/info`
    - ‚úÖ `/actuator/metrics`
    - ‚úÖ `/actuator/health/db`
    - ‚ùå `/api/actuator/health` (–Ω–µ —Å–æ–≤–ø–∞–¥–µ—Ç, —Ç.–∫. –Ω–µ—Ç `/actuator` –≤ –Ω–∞—á–∞–ª–µ)

### 3. `.permitAll()`
- –†–∞–∑—Ä–µ—à–∞–µ—Ç –¥–æ—Å—Ç—É–ø **–±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–∞—Ç—Ç–µ—Ä–Ω—É
- –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ: "–ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –¥–ª—è –≤—Å–µ—Ö, –¥–∞–∂–µ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"

## üîç –ß—Ç–æ —Ç–∞–∫–æ–µ Actuator?

**Spring Boot Actuator** - —ç—Ç–æ –º–æ–¥—É–ª—å –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º:

- `/actuator/health` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `/actuator/info` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- `/actuator/metrics` - –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- `/actuator/env` - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `/actuator/loggers` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∞–º–∏

–≠—Ç–∏ endpoints –Ω—É–∂–Ω—ã –¥–ª—è:
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (Prometheus, Grafana)
- ‚úÖ Health checks (Kubernetes, Docker)
- ‚úÖ –û—Ç–ª–∞–¥–∫–∏ –≤ production
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

## üí° –ó–∞—á–µ–º `permitAll()` –¥–ª—è Actuator?

–û–±—ã—á–Ω–æ Actuator endpoints –¥–µ–ª–∞—é—Ç –ø—É–±–ª–∏—á–Ω—ã–º–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ:

1. **Health checks** - Kubernetes/Docker –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏—Ö –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –Ω–µ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å credentials –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

‚ö†Ô∏è **–ù–æ**: –í production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞—â–∏—â–∞—Ç—å Actuator endpoints –∏–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ firewall/IP whitelist.

## üìù –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ SecurityConfig

```java
@Bean
public SecurityWebFilterChain securityWebFilterChain(ServerHttpSecurity http) {
    return http
        .csrf(csrf -> csrf.disable())
        .authorizeExchange(exchanges -> {
            // –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –¥–ª—è Actuator (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, health checks)
            exchanges.pathMatchers("/actuator/**").permitAll();
            
            // –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
            // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ @PreAuthorize –Ω–∞ –º–µ—Ç–æ–¥–∞—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
            exchanges.anyExchange().authenticated();
        })
        .httpBasic(httpBasic -> {})
        .build();
}
```

## üéØ –ü–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏

Spring Security –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ **—Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑**:

1. ‚úÖ –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `/actuator/**` ‚Üí `permitAll()` ‚Üí **–¥–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω**
2. ‚úÖ –ó–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `anyExchange()` ‚Üí `authenticated()` ‚Üí —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é

**–í–∞–∂–Ω–æ**: –ü–µ—Ä–≤–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª–æ!

## üîß –î—Ä—É–≥–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è pathMatchers

### –ü—Ä–∏–º–µ—Ä 1: –ù–µ—Å–∫–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã—Ö –ø—É—Ç–µ–π
```java
.authorizeExchange(exchanges -> {
    exchanges.pathMatchers("/actuator/**").permitAll();
    exchanges.pathMatchers("/api/public/**").permitAll();
    exchanges.pathMatchers("/swagger-ui/**").permitAll();
    exchanges.anyExchange().authenticated();
})
```

### –ü—Ä–∏–º–µ—Ä 2: –†–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –¥–æ—Å—Ç—É–ø–∞
```java
.authorizeExchange(exchanges -> {
    exchanges.pathMatchers("/actuator/**").permitAll();
    exchanges.pathMatchers("/api/admin/**").hasRole("ADMIN");
    exchanges.pathMatchers("/api/user/**").hasRole("USER");
    exchanges.anyExchange().authenticated();
})
```

### –ü—Ä–∏–º–µ—Ä 3: –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø—É—Ç–∏
```java
// –¢–æ–ª—å–∫–æ /api/public/info (–Ω–µ /api/public/info/extra)
exchanges.pathMatchers("/api/public/info").permitAll();
```

### –ü—Ä–∏–º–µ—Ä 4: –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
```java
// –°–æ–≤–ø–∞–¥–µ—Ç —Å /actuator/** –ò /swagger-ui/**
exchanges.pathMatchers("/actuator/**", "/swagger-ui/**").permitAll();
```

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

| –ü–∞—Ç—Ç–µ—Ä–Ω | –°–æ–≤–ø–∞–¥–µ—Ç | –ù–µ —Å–æ–≤–ø–∞–¥–µ—Ç |
|---------|----------|-------------|
| `/actuator/**` | `/actuator/health`, `/actuator/info/metrics` | `/api/actuator/health` |
| `/actuator/*` | `/actuator/health` (1 —É—Ä–æ–≤–µ–Ω—å) | `/actuator/health/db` (2 —É—Ä–æ–≤–Ω—è) |
| `/actuator/health` | `/actuator/health` (—Ç–æ—á–Ω–æ) | `/actuator/health/db` |

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **–ü–æ—Ä—è–¥–æ–∫ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ** - –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—ã—à–µ
2. **`**` –æ–∑–Ω–∞—á–∞–µ—Ç –ª—é–±–æ–π —É—Ä–æ–≤–µ–Ω—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏** - `/actuator/**` —Å–æ–≤–ø–∞–¥–µ—Ç —Å `/actuator/a/b/c`
3. **`*` –æ–∑–Ω–∞—á–∞–µ—Ç –æ–¥–∏–Ω —É—Ä–æ–≤–µ–Ω—å** - `/actuator/*` —Å–æ–≤–ø–∞–¥–µ—Ç —Ç–æ–ª—å–∫–æ —Å `/actuator/health`, –Ω–æ –Ω–µ —Å `/actuator/health/db`
4. **`permitAll()` –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç `authenticated()`** –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø—É—Ç–µ–π

## üéØ –ò—Ç–æ–≥–æ

```java
exchanges.pathMatchers("/actuator/**").permitAll();
```

**–û–∑–Ω–∞—á–∞–µ—Ç**: 
"–í—Å–µ HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ –ø—É—Ç—è–º, –Ω–∞—á–∏–Ω–∞—é—â–∏–º—Å—è —Å `/actuator/`, —Ä–∞–∑—Ä–µ—à–µ–Ω—ã **–±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–≤–∫–ª—é—á–∞—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö)"

–≠—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ health checks –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
